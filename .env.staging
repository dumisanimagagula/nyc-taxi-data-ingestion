# NYC Taxi Lakehouse - STAGING Environment
# ===========================================
# Production-like environment for validation

ENVIRONMENT=staging
PROJECT_NAME=nyc-taxi-lakehouse-staging
COMPOSE_PROJECT_NAME=lakehouse-staging

# Storage
MINIO_ROOT_USER=minio
MINIO_ROOT_PASSWORD=stagingMinio123!
AWS_ACCESS_KEY_ID=minio
AWS_SECRET_ACCESS_KEY=stagingMinio123!
AWS_ENDPOINT_URL=http://minio:9000
AWS_REGION=us-east-1

# Metastore
METASTORE_DB_USER=hive
METASTORE_DB_PASSWORD=stagingHive123!
METASTOREDB_NAME=metastore
HIVE_METASTORE_URI=thrift://hive-metastore:9083

# Spark (Production-like resources)
SPARK_MASTER_URL=spark://spark-master:7077
SPARK_WORKER_CORES=4
SPARK_WORKER_MEMORY=8g
SPARK_WORKER_INSTANCES=2
SPARK_DRIVER_MEMORY=2g
SPARK_EXECUTOR_MEMORY=6g

# Trino
TRINO_COORDINATOR_MEMORY=4GB
TRINO_WORKER_MEMORY=4GB

# Superset
SUPERSET_DB_USER=superset
SUPERSET_DB_PASSWORD=stagingSuperset123!
SUPERSET_DB_NAME=superset
SUPERSET_SECRET_KEY=staging_secret_key_change_this_1234567890
SUPERSET_ADMIN_USERNAME=admin
SUPERSET_ADMIN_PASSWORD=stagingAdmin123!
SUPERSET_LOAD_EXAMPLES=false

# Airflow
AIRFLOW_DB_USER=airflow
AIRFLOW_DB_PASSWORD=stagingAirflow123!
AIRFLOW_DB_NAME=airflow
AIRFLOW_ADMIN_USERNAME=airflow
AIRFLOW_ADMIN_PASSWORD=stagingAirflow123!
AIRFLOW_ADMIN_EMAIL=staging@company.com
AIRFLOW__CORE__EXECUTOR=LocalExecutor
AIRFLOW__CORE__LOAD_EXAMPLES=false
AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION=true

# Resource Limits (Production-like)
MINIO_CPU_LIMIT=1.0
MINIO_MEM_LIMIT=2g
MINIO_MEM_RESERVATION=1g

POSTGRES_CPU_LIMIT=1.0
POSTGRES_MEM_LIMIT=2g
POSTGRES_MEM_RESERVATION=1g

SPARK_MASTER_CPU_LIMIT=2.0
SPARK_MASTER_MEM_LIMIT=4g
SPARK_MASTER_MEM_RESERVATION=2g

SPARK_WORKER_CPU_LIMIT=4.0
SPARK_WORKER_MEM_LIMIT=10g
SPARK_WORKER_MEM_RESERVATION=8g

TRINO_CPU_LIMIT=4.0
TRINO_MEM_LIMIT=8g
TRINO_MEM_RESERVATION=4g

SUPERSET_CPU_LIMIT=2.0
SUPERSET_MEM_LIMIT=4g
SUPERSET_MEM_RESERVATION=2g

AIRFLOW_WEBSERVER_CPU_LIMIT=1.0
AIRFLOW_WEBSERVER_MEM_LIMIT=2g
AIRFLOW_WEBSERVER_MEM_RESERVATION=1g

AIRFLOW_SCHEDULER_CPU_LIMIT=2.0
AIRFLOW_SCHEDULER_MEM_LIMIT=2g
AIRFLOW_SCHEDULER_MEM_RESERVATION=1g

# Port Mappings
MINIO_API_PORT=9000
MINIO_CONSOLE_PORT=9001
SPARK_MASTER_PORT=7077
SPARK_MASTER_UI_PORT=8080
TRINO_UI_PORT=8086
SUPERSET_PORT=8088
AIRFLOW_PORT=8089
METASTORE_PORT=9083

# Healthcheck (Production settings)
HEALTHCHECK_INTERVAL=30s
HEALTHCHECK_TIMEOUT=10s
HEALTHCHECK_RETRIES=5
HEALTHCHECK_START_PERIOD=60s

# Restart Policy (Always restart in staging)
RESTART_POLICY=unless-stopped

# Logging (Production-like)
LOG_DRIVER=json-file
LOG_MAX_SIZE=10m
LOG_MAX_FILE=5

# Monitoring (Enabled for staging)
ENABLE_MONITORING=true
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000
GRAFANA_ADMIN_PASSWORD=stagingGrafana123!

# Security
ENFORCE_HTTPS=false

# Backup
BACKUP_ENABLED=true
BACKUP_RETENTION_DAYS=7
BACKUP_SCHEDULE="0 3 * * *"
